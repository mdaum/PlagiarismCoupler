<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>DiGraphCheater1.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>DiGraphCheater1.java</CENTER></H3><HR>
<PRE>
package DiGraph_A5;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Stack;

public class DiGraph implements DiGraphInterface {

	// in here go all your data and methods for the graph
<A NAME="0"></A>	// and the topo sort operation
	public long numNodes;
	public long numEdges;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#0',2,'match6-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public DiGraph_Node nodeArray[];
	HashMap&lt;String, DiGraph_Node&gt; hashmap = new HashMap();
	HashSet&lt;Long&gt; IDNode = new HashSet();
	HashSet&lt;Long&gt; IDEdge = new HashSet();</B></FONT>


	public DiGraph() { // default constructor
		numNodes = 0;
		numEdges = 0;
<A NAME="2"></A>		nodeArray = new DiGraph_Node[1000];
	}

<FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#2',2,'match6-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public boolean addNode(long idNum, String label) {
		if(idNum &lt; 0 || label == null || IDNode.contains(idNum) == true || hashmap.containsKey(label) == true){
			return false;
		}
		
		DiGraph_Node node = new DiGraph_Node(idNum, label);
		hashmap.put(label, node);
		nodeArray[(int) idNum] = node;
		IDNode.add(idNum);
		numNodes++;
		
		return true;
<A NAME="1"></A>		// adds node and returns true, increments number of nodes and puts it in hashmap/array
	}</B></FONT>

<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#1',2,'match6-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public boolean addEdge(long idNum, String sLabel, String dLabel, long weight, String eLabel) {
		if( IDEdge.contains(idNum) == true || idNum &lt; 0 || hashmap.containsKey(sLabel) == false 
				|| hashmap.containsKey(dLabel) == false || 
				isIn(hashmap.get(sLabel),dLabel) == true){
			return false;
		}
		
		DiGraph_Edges edge = new DiGraph_Edges(idNum, 1, eLabel);
		edge.nextEdge = hashmap.get(sLabel).edgeOne;
		hashmap.get(sLabel).edgeOne = edge;
		edge.thisNode = hashmap.get(dLabel);
		numEdges++;
		hashmap.get(sLabel).out++;
		hashmap.get(dLabel).in++;
		IDEdge.add(idNum);
		return true;
		
		// adds edge and returns true, increments number of edges
	}</B></FONT>

	public boolean delNode(String label) {
		if(hashmap.containsKey(label) == false){
			return false;
		}
		
		for(int i = 0; i &lt; nodeArray.length; i++){
			if(nodeArray[i] != null){
				this.delEdge(nodeArray[i].label, label);
			}
		}
		
		DiGraph_Node node = hashmap.get(label);
		nodeArray[(int) node.number] = null;
		IDNode.remove(node.number);
		hashmap.remove(label);
		numNodes--;
		
<A NAME="3"></A>		return true;
	}

<FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#3',2,'match6-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public boolean delEdge(String sLabel, String dLabel) {
		if(hashmap.containsKey(sLabel) == false || hashmap.containsKey(dLabel) == false ||
				hashmap.get(sLabel) == null || hashmap.get(dLabel) == null || 
				isIn(hashmap.get(sLabel), dLabel) == false){
			return false;
		}

		DiGraph_Edges temporaryEdge = hashmap.get(sLabel).edgeOne;
		DiGraph_Edges previousEdge = null;
		
		while(temporaryEdge != null){
			if(hashmap.get(dLabel) == temporaryEdge.thisNode){
				if(previousEdge == null){
					hashmap.get(sLabel).edgeOne = temporaryEdge.nextEdge;
				} else {
					previousEdge.nextEdge = temporaryEdge.nextEdge;
				}

				IDEdge.remove(temporaryEdge.number);
				numEdges--;
				hashmap.get(sLabel).out--;
				hashmap.get(dLabel).in--;
				return true;
			}
			previousEdge = temporaryEdge;
			temporaryEdge = temporaryEdge.nextEdge;
		}
		return false;
	}</B></FONT>

	public long numNodes() {
		return numNodes;
	}

	public long numEdges() {
<A NAME="5"></A>		return numEdges;
	}

<FONT color="#c8c2a7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#5',2,'match6-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public String[] topoSort() {
		DiGraph_Edges newEdge;
		String fn, tn;
		int yayInt = 0;
		
		String[] topoArray = new String[1000];
		Stack&lt;String&gt; extra = new Stack&lt;String&gt;();
		Stack&lt;String&gt; stack = new Stack&lt;String&gt;();
		int count = 0;
		
		for(int i = 0; i &lt; nodeArray.length; i++){
			if(nodeArray[i] != null){
				if(nodeArray[i].in == 0){
					stack.push(nodeArray[i].label);
				}
			}
		}
		while(stack.size() != 0){
			fn = stack.pop();
			topoArray[count] = fn;
			count++;
			newEdge = this.nodeArray[(int) hashmap.get(fn).number].edgeOne;
			while(newEdge != null){
				extra.push(newEdge.thisNode.label);
				newEdge = newEdge.nextEdge;
			}
			while(extra.size() &gt; 0){
				tn = extra.pop();
				this.delEdge(fn, tn);
				if(this.hashmap.get(tn).in == 0){
					stack.push(tn);
				}
			}
		}
		
		for(int i = 0; i &lt; topoArray.length; i++){
			if(topoArray[i] != null){
				yayInt += 1;
			}
		}
		
		if(yayInt != this.numNodes){
			return null;
		}
		
		String[] copy = new String[yayInt];
		for(int i = 0; i &lt; yayInt; i++){
			copy[i] = topoArray[i];
		}
<A NAME="4"></A>		return copy;
	}</B></FONT>

<FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match6-0.html#4',2,'match6-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	public boolean isIn(DiGraph_Node n, String s){
		DiGraph_Edges temp = n.edgeOne;
		
		while(temp != null){
			if(temp.thisNode == hashmap.get(s)){
				return true;
			} 
			temp = temp.nextEdge;
		}
		return false;
		
		// this method checks if it is in the hashmap
	}</B></FONT>
	
}
</PRE>
</BODY>
</HTML>

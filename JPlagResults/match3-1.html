<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>DiGraphTricks(Rename&Reorder_2).java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>DiGraphTricks(Rename&Reorder_2).java</CENTER></H3><HR>
<PRE>
package DiGraph_A5;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Stack;

public class DiGraph implements DiGraphInterface {
	public Node array[];
	HashMap&lt;String, Node&gt; dimap = new HashMap();
	public long edgeNums;

	// in here go all your data and methods for the graph
	// and the topo sort operation

	HashSet&lt;Long&gt; edges = new HashSet();

	public long nodeNums;
	HashSet&lt;Long&gt; nodes = new HashSet();
	public DiGraph() { // default constructor
		// explicitly include this
		// we need to have the default constructor
		// if you then write others, this one will still be there
		nodeNums = 0;
		edgeNums = 0;
<A NAME="0"></A>		array = new Node[1000];
	}

<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match3-0.html#0',2,'match3-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	@Override
	public boolean addEdge(long idNum, String sLabel, String dLabel, long weight, String eLabel) {
		if (edges.contains(idNum) == true || idNum &lt; 0 || dimap.containsKey(sLabel) == false
				|| dimap.containsKey(dLabel) == false || isIn(dimap.get(sLabel), dLabel) == true) {
			return false;
		}
		Edge edge = new Edge(idNum, 0, eLabel);
		edge.nextedge = dimap.get(sLabel).edge;
		dimap.get(sLabel).edge = edge;
		edge.points_to = dimap.get(dLabel);
		edgeNums++;
		dimap.get(sLabel).out++;
		dimap.get(dLabel).in++;
		edges.add(idNum);
		return true;
	}

	@Override
	public boolean addNode(long idNum, String label) {
		// TODO Auto-generated method stub
		if (idNum &lt; 0 || label == null || nodes.contains(idNum) == true || dimap.containsKey(label) == true) {</B></FONT>
			return false;
		}
<A NAME="2"></A>		Node node = new Node(idNum, label);
		dimap.put(label, node);
		array[(int) idNum] = node;
<FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match3-0.html#2',2,'match3-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>		nodes.add(idNum);
		nodeNums++;
		return true;
	}

	@Override
	public boolean delEdge(String sLabel, String dLabel) {
		// TODO Auto-generated method stub
		if (dimap.get(sLabel) == null || dimap.get(dLabel) == null || dimap.containsKey(sLabel) == false
				|| dimap.containsKey(dLabel) == false || isIn(dimap.get(sLabel), dLabel) == false) {
			return false;
		}
		Edge temporary = dimap.get(sLabel).edge;
		Edge previous = null;

		while (temporary != null) {
			if (dimap.get(dLabel) == temporary.points_to) { // if destination
															// node == what
															// node tempedge
															// points to
				if (previous == null) {
					dimap.get(sLabel).edge = temporary.nextedge;
				} else {
					previous.nextedge = temporary.nextedge;
				}
				edges.remove(temporary.idnum);
				edgeNums--;
				dimap.get(sLabel).out--;
				dimap.get(dLabel).in--;
				return true;
			}
			previous = temporary;</B></FONT>
			temporary = temporary.nextedge;
		}
		return false;
	}

	@Override
<A NAME="1"></A>	public boolean delNode(String label) {
		// TODO Auto-generated method stub
		if (dimap.containsKey(label) == false) {
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match3-0.html#1',2,'match3-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>			return false;
		}
		Node n = dimap.get(label);
		for (int i = 0; i &lt; array.length; i++) {
			if (array[i] != null) {
				this.delEdge(array[i].label, label);
			}
		}
		array[(int) n.idnum] = null;
		nodes.remove(n.idnum);</B></FONT>
		dimap.remove(label);
		nodeNums--;

		return true;
	}

	// rest of your code to implement the various operations
	public boolean isIn(Node n, String s) {
		Edge temp = n.edge;
		// Edge temp2 = digraph.get(s).edge;

		while (temp != null) {
<A NAME="3"></A>			if (temp.points_to == dimap.get(s)) {
				return true;
			}
<FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match3-0.html#3',2,'match3-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>			temp = temp.nextedge;
		}

		return false;
	}

	@Override
	public long numEdges() {
		// TODO Auto-generated method stub
		return edgeNums;
	}

	@Override
	public long numNodes() {
		// TODO Auto-generated method stub
		return nodeNums;
	}

	@Override
	public String[] topoSort() {
		// TODO Auto-generated method stub
		Edge element;
		String n, t;
		int hi = 0;

		String[] topo = new String[1000];
		Stack&lt;String&gt; sStack = new Stack&lt;String&gt;();
		Stack&lt;String&gt; stack = new Stack&lt;String&gt;();
		int counter = 0;

		for (int i = 0; i &lt; array.length; i++) {
			if (array[i] != null) {
				if (array[i].in == 0) {
					stack.push(array[i].label);
				}
			}
		}

		while (stack.size() != 0) {
			n = stack.pop();
			topo[counter] = n;
			// System.out.println(topo[counter]);
			counter++;
			element = this.array[(int) dimap.get(n).idnum].edge;
			while (element != null) {
				sStack.push(element.points_to.label);
				element = element.nextedge;
			}
			while (sStack.size() &gt; 0) {
				t = sStack.pop();
				this.delEdge(n, t);
				if (this.dimap.get(t).in == 0) {
					stack.push(t);
				}
			}
		}
		for (int i = 0; i &lt; topo.length; i++) {
			if (topo[i] != null) {
				hi += 1;
			}
		}
		if (hi != this.nodeNums) {
			return null;
		}

		String[] copy = new String[hi];
		for (int i = 0; i &lt; hi; i++) {
			copy[i] = topo[i];
		}

		return copy;

	}</B></FONT>

}
</PRE>
</BODY>
</HTML>
